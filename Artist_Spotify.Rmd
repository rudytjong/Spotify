---
title: "Artist Collaboration Network Analysis"
author: "Brandon Emery & Rudy Tjong"
date: "2025-05-28"
output: html_document
---

```{r library, include = FALSE}
library(tidyverse)
library(igraph)
library(tidygraph)
library(ggraph)
```

```{r}
# Step 1: Read the data
edges <- read_csv("edges.csv")   # Columns: id_0, id_1
nodes <- read_csv("nodes.csv")   # Columns: spotify_id, name, followers, etc.

# Step 2: Make sure node IDs match
nodes <- nodes %>%
  rename(id = spotify_id) %>%
  distinct(id, .keep_all = TRUE)
  
valid_ids <- nodes$id

edges_filtered <- edges %>%
filter (id_0 %in% valid_ids & id_1 %in% valid_ids)

# Step 3: Create graph from edge list and join with node data
g <- graph_from_data_frame(d = edges_filtered, vertices = nodes, directed = FALSE)

# Step 4: Basic network metrics
V(g)$degree <- degree(g)
V(g)$betweenness <- betweenness(g)
V(g)$pagerank <- page.rank(g)$vector

# Step 5: Community detection using Louvain algorithm
louvain_clusters <- cluster_louvain(g)
V(g)$community <- louvain_clusters$membership

# Step 6: Top artists by centrality
top_artists <- V(g)[order(-V(g)$degree)][1:10]
top_artists_info <- data.frame(
  name = V(g)$name[top_artists],
  degree = V(g)$degree[top_artists],
  popularity = V(g)$popularity[top_artists],
  followers = V(g)$followers[top_artists]
)
print(top_artists_info)

# Step 7: Optional Visualization (sampled to avoid overload)
set.seed(42)
sample_nodes <- sample(V(g), 500)
g_sub <- induced_subgraph(g, sample_nodes)
tg <- as_tbl_graph(g_sub)

# Visualization
ggraph(tg, layout = "fr") +
  geom_edge_link(alpha = 0.1) +
  geom_node_point(aes(color = as.factor(community), size = degree)) +
  geom_node_text(aes(label = name), size = 2, repel = TRUE) +
  theme_void() +
  labs(title = "Spotify Artist Collaboration Network (Sample)")
```



